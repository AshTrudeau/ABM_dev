annual.exploitation<-function(y, parameters, output, annualOutput){
  
  # for each lake, sum total harvest
  M<-parameters[["M"]]
  
  lakeStatus<-output[["lakeStatus"]]
  annualOutput.df<-annualOutput[["annualOutput"]]
  
  annualLakeStatus<-lakeStatus%>%
    filter(year==y)%>%
    group_by(lakeID)%>%
    summarize(year=y,
              fishPopStart=fishPop[which.min(day)],
              annualHarvest=sum(nHarvested),
              annualEffort=sum(nAnglers))%>%
    ungroup()%>%
    mutate(M=M,
           exploitation=annualHarvest/fishPopStart,
           survival=exp(-M)*(1-exploitation))
  
  annualOutput.df[annualOutput.df$year==y,]<-annualLakeStatus
  
  annualOutput[["annualOutput"]]<-annualOutput.df
  
  return(annualOutput)
  
}