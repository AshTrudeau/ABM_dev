annual.exploitation<-function(y, parameters, fishery, annualOutput){
  
  # Once I link M to temperature, it's going to need to be filled in by a separate
  # script instead of being read in as a parameter
  M<-parameters[["M"]]
  nLakes<-parameters[["nLakes"]]
  
  lakeStatus<-fishery[["lakeStatus"]]

  annualLakeStatus<-lakeStatus%>%
    # replace 1 with y
    filter(year==y)%>%
    group_by(lakeID)%>%
    # replace 1 with y
    summarize(year=y,
              fishNStart=fishN[which.min(day)],
              fishBStart=fishB[which.min(day)],
              annualHarvestN=sum(harvestedN),
              annualHarvestB=sum(harvestedB),
              annualEffort=sum(nAnglers))%>%
    ungroup()%>%
    mutate(M=M,
           exploitation=annualHarvestN/fishNStart,
           survival=exp(-M)*(1-exploitation),
           recruitment=rep(NA),
           fishNEnd=rep(NA),
           fishBEnd=rep(NA))

  annualOutput[annualOutput$year==y,]<-annualLakeStatus
  

  return(annualOutput)
  
}

